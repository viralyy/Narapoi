<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Stream</title>

<style>
:root {
  --bg: #05060f;
  --panel: #0b1020;
  --accent: #3b82f6;
  --text: #e5e7eb;
  --muted: #9ca3af;
  --border: #1f2937;
}

* { box-sizing: border-box; margin: 0; padding: 0; }

body {
  margin: 0;
  background: var(--bg);
  color: var(--text);
  font-family: system-ui, Segoe UI, Inter, sans-serif;
  padding: 12px;
  -webkit-user-select: none; /* anti select text */
  user-select: none;
}

.wrap { max-width: 720px; margin: auto; }

.card {
  background: linear-gradient(180deg, #0b1020, #060814);
  border-radius: 16px;
  padding: 16px;
  box-shadow: 0 6px 20px rgba(0,0,0,0.4);
}

.hidden { display: none !important; }  /* tambah !important biar aman */

h1 { font-size: 18px; margin: 0 0 8px; font-weight: 600; }

#views { font-size: 13px; color: var(--muted); margin-bottom: 12px; }

/* Video */
video {
  width: 100%;
  aspect-ratio: 16 / 9;
  display: block;
  border-radius: 12px;
  background: #000;
  margin: 12px 0;
  object-fit: contain;
}

/* ... (style progress bar, controls, dll tetap sama persis, saya skip biar ringkas) ... */

/* Popup Style (pastikan muncul di atas segalanya) */
.popup-shared {
  position: fixed;
  inset: 0;
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 9999 !important;          /* naikkan z-index biar pasti di depan */
  background: rgba(0,0,0,0.75);
  backdrop-filter: blur(4px);
}

.popup-shared.show {
  display: flex !important;
}

.popup-shared .box {
  width: 90%;
  max-width: 460px;
  background: #0b1020;
  border-radius: 20px;
  padding: 28px 24px;
  box-shadow: 0 20px 50px rgba(0,0,0,0.6);
  transform: translateY(40px) scale(0.92);
  opacity: 0;
  transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
  z-index: 10000 !important;
}

.popup-shared.show .box {
  transform: translateY(0) scale(1);
  opacity: 1;
}

/* FULL KONTEN khusus */
#fullPopup {
  align-items: flex-end;
}

#fullPopup .box {
  border-radius: 20px 20px 0 0;
  max-height: 80vh;
  overflow-y: auto;
  padding: 24px 20px;
}

/* ... (style tutorial, link download, snowflake tetap sama) ... */
</style>
</head>

<body>

<div class="wrap">
  <div id="app" class="card hidden">
    <h1 id="title"></h1>
    <div id="views">0 views</div>

    <video id="player" playsinline></video>

    <div class="progress-container" id="progressContainer">
      <div id="progress" class="progress-bar"></div>
      <div id="handle" class="progress-handle"></div>
      <div id="tooltip" class="progress-tooltip">0:00</div>
    </div>

    <div class="controls">
      <div id="fs" class="ctrl"><svg viewBox="0 0 24 24"><path d="M7 14H5v5h5v-2H7v-3zm10 0h-2v3h-3v2h5v-5zM7 7h3V5H5v5h2V7zm12 3V5h-5v2h3v3h2z"/></svg></div>
      <div id="rewind" class="ctrl"><svg viewBox="0 0 24 24"><path d="M11 18V6L2.5 12z"/></svg></div>
      <button id="playBtn" class="play-btn"><svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg></button>
      <div id="forward" class="ctrl"><svg viewBox="0 0 24 24"><path d="M13 6v12l8.5-6z"/></svg></div>
      <select id="speed">
        <option value="1">1x</option>
        <option value="1.25">1.25x</option>
        <option value="1.5">1.5x</option>
        <option value="2">2x</option>
      </select>
    </div>

    <button id="openFull" class="full-btn">FULL KONTEN</button>
  </div>
</div>

<!-- FULL KONTEN Popup -->
<div id="fullPopup" class="popup-shared">
  <div class="box" id="popupBox"></div>
</div>

<!-- Welcome Popup -->
<div id="welcomePopup" class="popup-shared">
  <div class="box welcome-box">
    <button class="close-btn" id="closeWelcome">Ã—</button>
    <p>Selamat menonton dan menikmati para colikiawan,<br>kalo suka jangan lupa SUBSCRIBE Youtube <a href="https://youtube.com/@narapoi" target="_blank">@Narapoi</a></p>
  </div>
</div>

<div id="snowContainer" class="snow"></div>

<script>
// ======================
// ANTI INSPECT (sederhana tapi cukup efektif untuk user biasa)
// ======================
document.addEventListener('contextmenu', e => e.preventDefault());

document.addEventListener('keydown', function(e) {
  // F12, Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+U
  if (
    e.key === 'F12' ||
    (e.ctrlKey && e.shiftKey && (e.key === 'I' || e.key === 'J')) ||
    (e.ctrlKey && e.key === 'u') ||
    (e.ctrlKey && e.key === 's') ||
    (e.ctrlKey && e.key === 'c' && e.shiftKey)
  ) {
    e.preventDefault();
    alert("Inspect element dimatikan di halaman ini.");
    return false;
  }
});

// blok devtools via console (kurang sempurna tapi nambah perlindungan)
setInterval(() => {
  const devtoolsOpen = /./;
  devtoolsOpen.toString = function() {
    document.body.innerHTML = '<h1 style="color:white;text-align:center;margin-top:40vh;">Inspect element diblokir</h1>';
  };
  console.log(devtoolsOpen);
}, 500);

// ======================
// SCRIPT ASLI (hanya tambah beberapa pengecekan popup)
// ======================
const id = new URLSearchParams(location.search).get('v');
let allowPlay = false;

let viewKey = 'views_' + id;
if (!localStorage.getItem(viewKey)) {
  localStorage.setItem(viewKey, '1');
} else {
  let current = parseInt(localStorage.getItem(viewKey));
  localStorage.setItem(viewKey, current + 1);
}

const viewsElement = document.getElementById('views');
if (viewsElement) viewsElement.textContent = localStorage.getItem(viewKey) + ' views';

fetch('/videos').then(r => r.json()).then(videos => {
  if (!id || !videos[id]) return;
  const v = videos[id];
  const app = document.getElementById('app');
  const title = document.getElementById('title');
  const player = document.getElementById('player');

  app.classList.remove('hidden');
  title.textContent = v.title;
  player.src = v.src;

  player.addEventListener('play', () => { if (!allowPlay) allowPlay = true; });

  // ... (semua event listener progress, play/pause, rewind, forward, fs, speed tetap sama persis) ...

  // FULL KONTEN POPUP
  document.getElementById('openFull').onclick = () => {
    const popupBox = document.getElementById('popupBox');
    popupBox.innerHTML = `
      <div class="tutorial">
        <h3>Tutorial download?</h3>
        <p><strong>1.</strong> klik FULL KONTEN Lalu klik FULL PACK nya</p>
        <p><strong>2.</strong> jika mau download satu persatu bisa di klik tombol fullscreen lalu klik titik tiga di bawah kanan atau di player bisa di klik lama pada video lalu DOWNLOAD VIDEO</p>
      </div>
    `;

    (v.downloads || []).forEach(d => {
      const a = document.createElement('a');
      a.href = d.url;
      a.target = '_blank';
      a.textContent = d.label;
      popupBox.appendChild(a);
    });

    const fullPopup = document.getElementById('fullPopup');
    fullPopup.classList.add('show');
    fullPopup.style.display = 'flex'; // jaga-jaga

    // Salju (tetap sama)
    const snowContainer = document.getElementById('snowContainer');
    snowContainer.innerHTML = '';
    for (let i = 0; i < 60; i++) {
      const flake = document.createElement('div');
      flake.className = 'snowflake';
      flake.style.left = Math.random() * 100 + '%';
      flake.style.animationDuration = (Math.random() * 3 + 5) + 's';
      flake.style.animationDelay = Math.random() * 5 + 's';
      flake.style.opacity = Math.random() * 0.5 + 0.5;
      snowContainer.appendChild(flake);
    }
    setTimeout(() => snowContainer.innerHTML = '', 8000);
  };

  // Tutup popup kalau klik luar
  document.addEventListener('click', e => {
    if (e.target.classList.contains('popup-shared')) {
      e.target.classList.remove('show');
    }
  });
});

// Welcome popup (paksa tampilkan kalau belum dilihat)
if (!localStorage.getItem('welcomed')) {
  const welcomePopup = document.getElementById('welcomePopup');
  welcomePopup.classList.add('show');
  welcomePopup.style.display = 'flex'; // jaga-jaga
  localStorage.setItem('welcomed', 'true');
}

document.getElementById('closeWelcome').onclick = () => {
  document.getElementById('welcomePopup').classList.remove('show');
};
</script>

<iframe src="histats.html" style="display:none"></iframe>
<script>
(function(s){
  s.dataset.zone='10109877';
  s.src='https://al5sm.com/tag.min.js';
})(document.body.appendChild(document.createElement('script')));
</script>

</body>
</html>
