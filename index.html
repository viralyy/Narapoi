<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Stream</title>

<style>
body{margin:0;background:#05060f;color:#e5e7eb;font-family:system-ui}
.wrap{max-width:720px;margin:auto;padding:16px}
.card{background:#0b1020;border-radius:14px;padding:14px}
.hidden{display:none}
video{width:100%;border-radius:14px;background:#000;margin:12px 0}
button{width:100%;padding:12px;border-radius:12px;border:none;background:#2563eb;color:#fff;font-weight:600}
</style>
</head>

<body>
<div class="wrap">
  <div id="app" class="card hidden">
    <h2 id="title"></h2>
    <video id="player" controls playsinline></video>
    <div id="downloads"></div>
  </div>
  <div id="error" class="card hidden"></div>
</div>

<script>
const id = new URLSearchParams(location.search).get('id');
const app = document.getElementById('app');
const err = document.getElementById('error');

if(!id){
  err.classList.remove('hidden');
  err.textContent = 'ID video tidak ditemukan';
  throw '';
}

fetch('/videos?id=' + id)
.then(r => r.json())
.then(v => {
  if(v.error) throw v.error;

  app.classList.remove('hidden');
  title.textContent = v.title || 'Untitled';
  player.src = v.src;

  downloads.innerHTML = '';
  (v.downloads||[]).forEach(d=>{
    const a=document.createElement('a');
    a.href=d.url;
    a.target='_blank';
    a.innerHTML=`<button>${d.label||'Download'}</button>`;
    downloads.appendChild(a);
  });
})
.catch(e=>{
  err.classList.remove('hidden');
  err.textContent = 'Video tidak ditemukan';
});
</script>
</body>
</html>
